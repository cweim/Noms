---
phase: 08-restaurant-cards
plan: 01
type: execute
---

<objective>
Create a swipeable restaurant card component with gesture handling for skip/like actions.

Purpose: Enable the core decision-making interaction - users swipe cards to quickly decide on restaurants. This is fundamental to the "decide where to eat now" user job.
Output: RestaurantCard component with swipe left (skip) and swipe right (like) gestures, visual feedback during swipe.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context
@.planning/phases/07-map-view/07-02-SUMMARY.md

# Current mobile setup
@mobile/package.json
@mobile/components/PlaceMarker.tsx

**Tech stack available:**
- Expo ~54.0.31 with React 19.1.0
- react-native-maps 1.20.1
- expo-location ~19.0.8
- Place interface from PlaceMarker.tsx

**Established patterns:**
- UI_SPEC colors: background #F5F5F5, text #1F2937, accent #F97316
- components/ directory for reusable components
- lib/ directory for shared utilities
- Ionicons from @expo/vector-icons

**UX Principles from PROJECT.md:**
- Interfaces should feel calm and low-density
- App must be usable with one hand
- Playful and tactile design (warm colors, soft shadows, rounded shapes)
- User can select a restaurant within 60 seconds
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install gesture and animation packages</name>
  <files>mobile/package.json, mobile/app/_layout.tsx</files>
  <action>
    1. Install packages using expo install (NOT npm install):
       ```
       cd mobile && npx expo install react-native-gesture-handler react-native-reanimated
       ```

    2. Update mobile/app/_layout.tsx to wrap with GestureHandlerRootView:
       ```tsx
       import { GestureHandlerRootView } from 'react-native-gesture-handler';

       // Wrap the entire app with GestureHandlerRootView
       export default function RootLayout() {
         return (
           <GestureHandlerRootView style={{ flex: 1 }}>
             <AuthProvider>
               <Stack screenOptions={{ headerShown: false }} />
             </AuthProvider>
           </GestureHandlerRootView>
         );
       }
       ```

    GestureHandlerRootView MUST wrap the entire app for gestures to work properly.
    Use npx expo install to get Expo SDK 54 compatible versions.
  </action>
  <verify>
    1. cd mobile && npm ls react-native-gesture-handler react-native-reanimated (packages installed)
    2. _layout.tsx contains GestureHandlerRootView wrapper
  </verify>
  <done>
    - react-native-gesture-handler and react-native-reanimated installed
    - GestureHandlerRootView wraps entire app
    - Ready for gesture-based components
  </done>
</task>

<task type="auto">
  <name>Task 2: Create RestaurantCard component</name>
  <files>mobile/components/RestaurantCard.tsx</files>
  <action>
    Create a card component that displays restaurant details:

    ```tsx
    import { View, Text, Image, StyleSheet, Dimensions } from 'react-native';
    import { Ionicons } from '@expo/vector-icons';
    import { Place } from './PlaceMarker';

    const { width: SCREEN_WIDTH } = Dimensions.get('window');
    const CARD_WIDTH = SCREEN_WIDTH - 40; // 20px margin on each side

    interface RestaurantCardProps {
      place: Place;
      photoUrl?: string;
    }

    export function RestaurantCard({ place, photoUrl }: RestaurantCardProps) {
      return (
        <View style={styles.card}>
          {/* Photo placeholder or actual image */}
          <View style={styles.imageContainer}>
            {photoUrl ? (
              <Image source={{ uri: photoUrl }} style={styles.image} />
            ) : (
              <View style={styles.imagePlaceholder}>
                <Ionicons name="restaurant" size={48} color="#9CA3AF" />
              </View>
            )}
          </View>

          {/* Restaurant info */}
          <View style={styles.info}>
            <Text style={styles.name} numberOfLines={1}>{place.name}</Text>

            <View style={styles.ratingRow}>
              {place.rating && (
                <>
                  <Ionicons name="star" size={16} color="#F97316" />
                  <Text style={styles.rating}>{place.rating.toFixed(1)}</Text>
                </>
              )}
            </View>

            {place.address && (
              <Text style={styles.address} numberOfLines={2}>{place.address}</Text>
            )}
          </View>

          {/* Swipe hint icons */}
          <View style={styles.hintContainer}>
            <View style={styles.hintLeft}>
              <Ionicons name="close" size={24} color="#EF4444" />
            </View>
            <View style={styles.hintRight}>
              <Ionicons name="heart" size={24} color="#22C55E" />
            </View>
          </View>
        </View>
      );
    }
    ```

    Styling requirements:
    - Card: White background, rounded corners (16px), shadow for depth
    - Image: Top portion of card, 60% height, gray placeholder if no photo
    - Info section: Padding, clear hierarchy (name large, rating medium, address small)
    - Hint icons: Subtle indicators at left/right edges for skip/like
    - Overall: Calm, low-density feel per UX principles

    Card dimensions: Nearly full width (SCREEN_WIDTH - 40), aspect ratio ~3:4.
  </action>
  <verify>
    1. File exists: mobile/components/RestaurantCard.tsx
    2. cd mobile && npm run tsc (no TypeScript errors)
    3. Component exports RestaurantCard function
  </verify>
  <done>
    - RestaurantCard component created
    - Displays name, rating, address
    - Photo placeholder when no image
    - Swipe hint icons visible
    - Matches UI_SPEC styling
  </done>
</task>

<task type="auto">
  <name>Task 3: Add swipe gesture handling</name>
  <files>mobile/components/SwipeableCard.tsx</files>
  <action>
    Create a wrapper component that adds swipe gestures to RestaurantCard:

    ```tsx
    import { useCallback } from 'react';
    import { StyleSheet, Dimensions } from 'react-native';
    import Animated, {
      useSharedValue,
      useAnimatedStyle,
      useAnimatedGestureHandler,
      withSpring,
      runOnJS,
      interpolate,
      Extrapolate,
    } from 'react-native-reanimated';
    import { PanGestureHandler, PanGestureHandlerGestureEvent } from 'react-native-gesture-handler';
    import { Place } from './PlaceMarker';
    import { RestaurantCard } from './RestaurantCard';

    const { width: SCREEN_WIDTH } = Dimensions.get('window');
    const SWIPE_THRESHOLD = SCREEN_WIDTH * 0.3; // 30% of screen width to trigger action

    interface SwipeableCardProps {
      place: Place;
      photoUrl?: string;
      onSkip: (place: Place) => void;
      onLike: (place: Place) => void;
    }

    export function SwipeableCard({ place, photoUrl, onSkip, onLike }: SwipeableCardProps) {
      const translateX = useSharedValue(0);
      const translateY = useSharedValue(0);

      const gestureHandler = useAnimatedGestureHandler<
        PanGestureHandlerGestureEvent,
        { startX: number; startY: number }
      >({
        onStart: (_, ctx) => {
          ctx.startX = translateX.value;
          ctx.startY = translateY.value;
        },
        onActive: (event, ctx) => {
          translateX.value = ctx.startX + event.translationX;
          // Slight vertical movement for natural feel
          translateY.value = ctx.startY + event.translationY * 0.3;
        },
        onEnd: (event) => {
          if (translateX.value > SWIPE_THRESHOLD) {
            // Swiped right - Like
            translateX.value = withSpring(SCREEN_WIDTH * 1.5);
            runOnJS(onLike)(place);
          } else if (translateX.value < -SWIPE_THRESHOLD) {
            // Swiped left - Skip
            translateX.value = withSpring(-SCREEN_WIDTH * 1.5);
            runOnJS(onSkip)(place);
          } else {
            // Return to center
            translateX.value = withSpring(0);
            translateY.value = withSpring(0);
          }
        },
      });

      const animatedStyle = useAnimatedStyle(() => {
        const rotate = interpolate(
          translateX.value,
          [-SCREEN_WIDTH, 0, SCREEN_WIDTH],
          [-15, 0, 15],
          Extrapolate.CLAMP
        );

        return {
          transform: [
            { translateX: translateX.value },
            { translateY: translateY.value },
            { rotate: `${rotate}deg` },
          ],
        };
      });

      // Opacity for swipe indicators based on swipe direction
      const likeOpacityStyle = useAnimatedStyle(() => ({
        opacity: interpolate(translateX.value, [0, SWIPE_THRESHOLD], [0, 1], Extrapolate.CLAMP),
      }));

      const skipOpacityStyle = useAnimatedStyle(() => ({
        opacity: interpolate(translateX.value, [-SWIPE_THRESHOLD, 0], [1, 0], Extrapolate.CLAMP),
      }));

      return (
        <PanGestureHandler onGestureEvent={gestureHandler}>
          <Animated.View style={[styles.container, animatedStyle]}>
            <RestaurantCard place={place} photoUrl={photoUrl} />
            {/* Overlay indicators that appear during swipe */}
            <Animated.View style={[styles.likeOverlay, likeOpacityStyle]}>
              {/* LIKE indicator */}
            </Animated.View>
            <Animated.View style={[styles.skipOverlay, skipOpacityStyle]}>
              {/* SKIP indicator */}
            </Animated.View>
          </Animated.View>
        </PanGestureHandler>
      );
    }
    ```

    Key behaviors:
    - Swipe right (> 30% screen width) → onLike callback, card flies off right
    - Swipe left (> 30% screen width) → onSkip callback, card flies off left
    - Release before threshold → spring back to center
    - Slight rotation during swipe for tactile feel (max ±15°)
    - Slight vertical drag allowed for natural gesture feel

    Use withSpring for smooth, bouncy animations matching "playful and tactile" UX principle.
  </action>
  <verify>
    1. File exists: mobile/components/SwipeableCard.tsx
    2. cd mobile && npm run tsc (no TypeScript errors)
    3. Component exports SwipeableCard with onSkip and onLike props
  </verify>
  <done>
    - SwipeableCard component created
    - Swipe left triggers onSkip callback
    - Swipe right triggers onLike callback
    - Card rotates during swipe
    - Springs back if not past threshold
    - Smooth animations with react-native-reanimated
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] react-native-gesture-handler and react-native-reanimated installed
- [ ] GestureHandlerRootView wraps app in _layout.tsx
- [ ] RestaurantCard component displays place info with proper styling
- [ ] SwipeableCard component handles swipe gestures
- [ ] Swipe left/right triggers appropriate callbacks
- [ ] No TypeScript errors: cd mobile && npm run tsc
</verification>

<success_criteria>

- All tasks completed
- Card component displays restaurant info attractively
- Swipe gestures feel responsive and natural
- Skip (left) and Like (right) callbacks work
- Animations are smooth and playful
</success_criteria>

<output>
After completion, create `.planning/phases/08-restaurant-cards/08-01-SUMMARY.md`

Phase 8 complete with this single plan - ready for Phase 9: Restaurant Picker Logic
</output>
