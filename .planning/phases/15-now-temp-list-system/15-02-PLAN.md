---
phase: 15-now-temp-list-system
plan: 02
type: execute
---

<objective>
Create temp list overlay UI for reviewing "Consider now" places

Purpose: Allow users to view all places they've swiped up on, select a final choice, or dismiss items from the temp list.
Output: TempListOverlay component with expandable list view and selection flow
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-now-temp-list-system/15-01-SUMMARY.md

**Key files to modify:**
@mobile/app/(tabs)/now.tsx
@mobile/components/SwipeableBottomCard.tsx (created in 15-01)

**New files:**
mobile/components/TempListOverlay.tsx

**Current state (after 15-01):**
- nowList state in Now screen tracks places swiped up
- Count indicator shows "X considering" badge
- SwipeableBottomCard handles swipe up gesture

**Target state:**
- Tapping count badge expands TempListOverlay
- Overlay shows list of considered places with photos and names
- Each item has: name, rating, remove button (X)
- "Go here!" button to select as final choice
- Selecting clears nowList and shows selected place in card
- Overlay can be collapsed by tapping outside or swipe down
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TempListOverlay component</name>
  <files>mobile/components/TempListOverlay.tsx</files>
  <action>
  Create expandable overlay showing the "Consider now" temp list:

  Layout (when expanded):
  ```
  ┌────────────────────────────────────┐
  │  Considering (3)            [Done] │
  ├────────────────────────────────────┤
  │ [Photo] Restaurant Name  ★4.5  [X] │
  │ [Photo] Another Place    ★4.2  [X] │
  │ [Photo] Third Option     ★4.8  [X] │
  └────────────────────────────────────┘
  ```

  Props interface:
  - places: Place[]
  - token: string | null (for photo URLs)
  - onRemove: (place: Place) => void
  - onSelect: (place: Place) => void
  - onClose: () => void

  Features:
  1. Header with "Considering (N)" title and "Done" button (calls onClose)
  2. ScrollView/FlatList of place items:
     - Small photo (60x60) on left
     - Name and rating in middle
     - Remove (X) button on right (calls onRemove)
  3. Tapping a place row calls onSelect with that place
  4. Animated entry from bottom (slide up)
  5. Semi-transparent backdrop (tapping backdrop calls onClose)
  6. Max height: 60% of screen, scrollable if more items
  7. Style: White card with rounded top corners, shadow

  Design:
  - Calm, low-density (adequate spacing between items)
  - Item height: ~70px
  - Photo: rounded corners (8px)
  - Remove button: subtle gray X, becomes red on press
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>TempListOverlay component created with list view and selection capability</done>
</task>

<task type="auto">
  <name>Task 2: Integrate overlay into Now screen</name>
  <files>mobile/app/(tabs)/now.tsx</files>
  <action>
  Add TempListOverlay to Now screen with show/hide state:

  1. Add overlay visibility state:
     ```typescript
     const [showTempList, setShowTempList] = useState(false);
     ```

  2. Make count badge tappable:
     - Wrap in TouchableOpacity
     - onPress={() => setShowTempList(true)}

  3. Add overlay handlers:
     ```typescript
     const handleRemoveFromList = (place: Place) => {
       setNowList(prev => prev.filter(p => p.google_place_id !== place.google_place_id));
       // If list becomes empty, close overlay
       if (nowList.length === 1) {
         setShowTempList(false);
       }
     };

     const handleSelectPlace = (place: Place) => {
       // Clear nowList
       setNowList([]);
       // Close overlay
       setShowTempList(false);
       // Remove from skippedIds so it becomes current card again
       setSkippedIds(prev => {
         const next = new Set(prev);
         next.delete(place.google_place_id);
         return next;
       });
       // The place will now be shown as current card (since it's back in rankedPlaces)
     };
     ```

  4. Render TempListOverlay conditionally:
     ```tsx
     {showTempList && nowList.length > 0 && (
       <TempListOverlay
         places={nowList}
         token={token}
         onRemove={handleRemoveFromList}
         onSelect={handleSelectPlace}
         onClose={() => setShowTempList(false)}
       />
     )}
     ```

  5. Position overlay:
     - Absolute position, full screen
     - Above the bottom card (zIndex)
     - Backdrop covers map

  6. Handle empty nowList:
     - If last item removed, auto-close overlay
     - If all cards exhausted and nowList has items, show overlay automatically
  </action>
  <verify>App compiles, tapping badge shows overlay, can remove/select places</verify>
  <done>TempListOverlay integrated with Now screen, full review flow works</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] TypeScript check passes: `cd mobile && npx tsc --noEmit`
- [ ] TempListOverlay component exists and renders place list
- [ ] Tapping count badge opens overlay
- [ ] Can remove individual places from list
- [ ] Selecting a place makes it the current card
- [ ] Overlay closes when tapping backdrop or "Done"
- [ ] Selecting clears the nowList
</verification>

<success_criteria>
- Full temp list review flow implemented
- Can view, remove, and select from considered places
- Selecting a place returns it as current card
- UI is calm and low-density
- No TypeScript errors
- Phase 15 complete
</success_criteria>

<output>
After completion, create `.planning/phases/15-now-temp-list-system/15-02-SUMMARY.md`
</output>
